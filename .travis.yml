language: generic
matrix:
  include:
    - os: windows
      language: sh
      python: "3.7"
      before_install:
        - choco install python3
        - export PATH="/c/Python37:/c/Python37/Scripts:$PATH"
        - python --version
        - python -m pip install --upgrade pip wheel
    - os: windows
      language: sh
      python: "2.7"
      before_install:
        - choco install python2
        - export PATH="/c/Python27:/c/Python27/Scripts:$PATH"
        - python --version
        - python -m pip install --upgrade pip wheel
install: 
    - pip install .
    - pip install pytest
env:
    PYTEST_SKIP_EXCEL=yes
script:
    - py.test
    - python excel2img/excel2img.py

deploy:
  provider: pypi
  on:
    tags: true
    branch:
      - master
      - /(\d+\.)?(\d+\.)?(\*|\d+)$/
  user: glexey
  password:
      secure: MbbNKbk+AObtIphJdFlU14tvshJyJnjCUO+tax072xW1IU3SidB3vbRvfLMId3pIjhEuY+XlXbcxFNkUofYsBaUbR2TDRknEuFZfD094ZjL4U6HSuI6dB2gydQcvenVtTDV5jy5pPMJ0Qddc8DSG0i5Y1Gs/mdxkoXx58wXCUHjIJs7HCmM5+cZNVJCgtoCQyWycSU827RySqjjSU0A0s7UW9xqu8cjrq6oZ84n6dGBdyvmkpKhyrgbVKtqbOKdY6ybpc6N9EexZ6w1/t/UjyJWYF2JVsxIgofDEHktMRPSptzDw7DWjuPBEfYxFl8YilK0sgEjxx0qEhrKRI3NTbUgSXrAEedy73+deU5Q5VidpqR8bgqo8IJ05fg0Xu1K/TxPLK042fpPrBMsU/56eYmBnlqtV2iPGIC3yWLJ9E558hwz1SMLowxzoNbm1h7koIhikqwbW4a7uesu9Yvt2ccmDa5r5nEHt6qQO3npdyJtVY/CI9+PsQ0OzMsIpLSnQIxXzaqS8/WSZQjlDuNuIqmhfJagWPJMyCN6DglkD7ZLtCaF2iOktrg3jG/TM+9gMQeJrCBUtqOnpbTx9f8+XaYoXegkX1yH1yIhMrGYRXnFGJ9SN665apNtDcrbKjDV9BTz/NcGzYYVpr0O8OtnNqOR9gndkV7rpwOWnkiZlTRE=

